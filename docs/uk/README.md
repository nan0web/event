# @nan0web/event

| –ù–∞–∑–≤–∞ –ø–∞–∫–µ—Ç–∞ | [–°—Ç–∞—Ç—É—Å](https://github.com/nan0web/monorepo/blob/main/system.md#–Ω–∞–ø–∏—Å–∞–Ω–Ω—è-—Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤) | –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è | –ü–æ–∫—Ä–∏—Ç—Ç—è —Ç–µ—Å—Ç–∞–º–∏ | –ú–æ–∂–ª–∏–≤–æ—Å—Ç—ñ | –í–µ—Ä—Å—ñ—è Npm |
|---|---|---|---|---|---|
|[@nan0web/event](https://github.com/nan0web/event/) |üü¢ `98.8%` |üß™ [–ê–Ω–≥–ª—ñ–π—Å—å–∫–æ—é üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø](https://github.com/nan0web/event/blob/main/README.md)<br />[–£–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é üá∫üá¶](https://github.com/nan0web/event/blob/main/docs/uk/README.md) |üü¢ `94.5%` |‚úÖ d.ts üìú system.md üïπÔ∏è playground |‚Äî |

–ê–≥–Ω–æ—Å—Ç–∏—á–Ω–∞ —Ç–∞ —Ä–æ–∑—à–∏—Ä—é–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –ø–æ–¥—ñ–π –¥–ª—è JavaScript —Å–µ—Ä–µ–¥–æ–≤–∏—â.  
–ù–∞–¥–∞—î —á–∏—Å—Ç—ñ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏ –¥–ª—è –≤–∏–∫–ª–∏–∫—É —Ç–∞ –æ–±—Ä–æ–±–∫–∏ –ø–æ–¥—ñ–π –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é –∫–æ–Ω—Ç–µ–∫—Å—Ç—É.

–°—Ç–≤–æ—Ä–µ–Ω–æ –∑–∞ [—Ñ—ñ–ª–æ—Å–æ—Ñ—ñ—î—é nan0web](https://github.com/nan0web/monorepo/blob/main/system.md#nanweb-nan0web):  
–¥–µ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –∫–æ–¥ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É, –±–µ—Ä—É—á–∏ –¥–æ —É–≤–∞–≥–∏ CPU —Ç–∞ –ø–∞–º‚Äô—è—Ç—å.

## –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

–Ø–∫ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —á–µ—Ä–µ–∑ npm?
```bash
npm install @nan0web/event
```

–Ø–∫ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —á–µ—Ä–µ–∑ pnpm?
```bash
pnpm add @nan0web/event
```

–Ø–∫ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —á–µ—Ä–µ–∑ yarn?
```bash
yarn add @nan0web/event
```

## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –ë–∞–∑–æ–≤–∏–π –µ–º—ñ—Ç–µ—Ä –ø–æ–¥—ñ–π

–°—Ç–≤–æ—Ä–∏ –µ–∫–∑–µ–º–ø–ª—è—Ä —à–∏–Ω–∏ –ø–æ–¥—ñ–π —Ç–∞ —Å–ª—É—Ö–∞–π –≤–ª–∞—Å–Ω—ñ –ø–æ–¥—ñ—ó.

–Ø–∫ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –±–∞–∑–æ–≤—É —à–∏–Ω—É –ø–æ–¥—ñ–π —Ç–∞ —Å–ª—É—Ö–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è?
```js
import event from "@nan0web/event"
const bus = event()
let messageReceived = false

bus.on("message", (ctx) => {
  messageReceived = true
  console.info(`–û—Ç—Ä–∏–º–∞–Ω–æ: ${ctx.data.text}`)
})

await bus.emit("message", { text: "–ü—Ä–∏–≤—ñ—Ç, —Å–≤—ñ—Ç–µ!" })

```
### –ó–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ–π –ø–æ–≤–µ–¥—ñ–Ω—Ü—ñ

–°–∫–∞—Å—É–π –ø–æ–¥–∞–ª—å—à–µ –ø–æ—à–∏—Ä–µ–Ω–Ω—è –ø–æ–¥—ñ—ó —á–µ—Ä–µ–∑ `preventDefault`.

–Ø–∫ –∑–∞–ø–æ–±—ñ–≥—Ç–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ–π –æ–±—Ä–æ–±—Ü—ñ –ø–æ–¥—ñ—ó –≤ —Å–ª—É—Ö–∞—á—ñ?
```js
import event from "@nan0web/event"
const bus = event()
let callCount = 0

bus.on("stop", (ctx) => {
  callCount++
  ctx.preventDefault()
})

bus.on("stop", () => {
  callCount++
})

const result = await bus.emit("stop", {})
```
### –ö–æ–º–∞–Ω–¥–∏ –∑ –ø–∞–π–ø–ª–∞–π–Ω–æ–º –ø–æ–¥—ñ–π

–ö–æ–º–∞–Ω–¥–∏ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å –ø–æ–≤–Ω–∏–π –ø–∞–π–ø–ª–∞–π–Ω –≤–∏–∫–æ–Ω–∞–Ω–Ω—è: `before`, `success` —Ç–∞ `error`.  
–ö–æ–Ω—Ç–µ–∫—Å—Ç –Ω–µ –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è –º—ñ–∂ —ñ—Ç–µ—Ä–∞—Ü—ñ—è–º–∏.

–Ø–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∫–æ–º–∞–Ω–¥–∏ –∑ –ø–∞–π–ø–ª–∞–π–Ω–æ–º –ø–æ–¥—ñ–π?
```js
import { createCommand } from "@nan0web/event/command"

const countCommand = createCommand("count", async (ctx) => {
  ctx.meta.totalCount = (ctx.meta.totalCount || 0) + 1
  console.info(`–ü—Ä–æ–≥—Ä–µ—Å ${ctx.data.iteration}: ${ctx.meta.totalCount} –ø–æ–¥—ñ–π –æ–±—Ä–æ–±–ª–µ–Ω–æ`)
})

countCommand.on("before", () => {
  console.info("–õ—ñ—á–∏–ª—å–Ω–∏–∫ –∑–∞–ø—É—â–µ–Ω–æ")
})

for (let i = 0; i < 2; i++) {
  await countCommand.execute({ iteration: i })
}

```
### –í–ª–∞—Å–Ω–∏–π –∫–ª–∞—Å –ø–æ–¥—ñ–π (–û–û–ü —Å—Ç–∏–ª—å)

–†–æ–∑—à–∏—Ä –∫–ª–∞—Å `Event`, —â–æ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Å–≤–æ—é —Å–∏—Å—Ç–µ–º—É –ø–æ–¥—ñ–π.

–Ø–∫ —Ä–æ–∑—à–∏—Ä–∏—Ç–∏ –∫–ª–∞—Å Event –¥–ª—è –≤–ª–∞—Å–Ω–æ—ó —à–∏–Ω–∏ –ø–æ–¥—ñ–π?
```js
import Event from "@nan0web/event/oop"

class TestEvent extends Event {
  async ping() {
    return await this.emit('ping', {})
  }
}

const instance = new TestEvent()
let received = false

instance.on('ping', () => {
  received = true
})

await instance.ping()

```
### –†–æ–±–æ—Ç–∞ –∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –ø–æ–¥—ñ—ó

`EventContext` –Ω–∞–¥–∞—î –±–∞–≥–∞—Ç–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –ø—Ä–æ –ø–æ–¥—ñ—é.

–Ø–∫ –º–∞–Ω—ñ–ø—É–ª—é–≤–∞—Ç–∏ —Ç–∞ –∫–ª–æ–Ω—É–≤–∞—Ç–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∏ –ø–æ–¥—ñ–π?
```js
import { EventContext } from "@nan0web/event"

const ctx = EventContext.from({
  type: "message",
  data: { text: "ping" },
  meta: { id: 1 }
})

const clone = ctx.clone()
clone.data.ping = true
console.log(ctx.data) // { text: "ping" }
console.info(clone.data) // { text: "ping", ping: true }

```
## API

### `event()`

–°—Ç–≤–æ—Ä—é—î –Ω–æ–≤–∏–π –µ–º—ñ—Ç–µ—Ä –ø–æ–¥—ñ–π, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ in-memory –∞–¥–∞–ø—Ç–µ—Ä.

* **–ú–µ—Ç–æ–¥–∏**
  * `on(event, listener)` ‚Äì –∑–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ —Å–ª—É—Ö–∞—á–∞ –ø–æ–¥—ñ—ó
  * `off(event, listener)` ‚Äì —Å–∫–∞—Å—É–≤–∞—Ç–∏ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—é —Å–ª—É—Ö–∞—á–∞
  * `emit(event, data)` ‚Äì —ñ–Ω—ñ—Ü—ñ—é–≤–∞—Ç–∏ –ø–æ–¥—ñ—é –∑ –¥–∞–Ω–∏–º–∏

### `createCommand(name, handler)`

* **–ú–µ—Ç–æ–¥–∏**
  * `on(event, listener)` ‚Äì –∑–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ –ø–æ–¥—ñ—é –ø–∞–π–ø–ª–∞–π–Ω–∞
  * `off(event, listener)` ‚Äì –≤–∏–¥–∞–ª–∏—Ç–∏ –ø–æ–¥—ñ—é –ø–∞–π–ø–ª–∞–π–Ω–∞
  * `execute(data)` ‚Äì –≤–∏–∫–æ–Ω–∞—Ç–∏ –∫–æ–º–∞–Ω–¥—É —Ç–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ —ó—ó –ø–∞–π–ø–ª–∞–π–Ω

### `EventContext`

–ö–æ–Ω—Ç–µ–∫—Å—Ç, —â–æ –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è –∫–æ–∂–Ω–æ–º—É —Å–ª—É—Ö–∞—á—É.

* **–í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ**
  * `type` ‚Äì —Ç–∏–ø –ø–æ–¥—ñ—ó
  * `name` ‚Äì –Ω–∞–∑–≤–∞ –∫–æ–º–∞–Ω–¥–∏ (—è–∫—â–æ —î)
  * `data` ‚Äì –¥–∞–Ω—ñ –ø–æ–¥—ñ—ó
  * `meta` ‚Äì –º–µ—Ç–∞–¥–∞–Ω—ñ –ø–æ–¥—ñ—ó
  * `error` ‚Äì –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ–º–∏–ª–∫–∏ (—è–∫—â–æ —î)
  * `defaultPrevented` ‚Äì –ø–æ–∑–Ω–∞—á–∞—î, —á–∏ –±—É–ª–æ –≤–∏–∫–ª–∏–∫–∞–Ω–æ preventDefault

* **–ú–µ—Ç–æ–¥–∏**
  * `preventDefault()` ‚Äì —Å–∫–∞—Å–æ–≤—É—î –ø–æ—à–∏—Ä–µ–Ω–Ω—è –ø–æ–¥—ñ—ó
  * `clone()` ‚Äì —Å—Ç–≤–æ—Ä—é—î –∫–æ–ø—ñ—é –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –ø–æ–¥—ñ—ó
  * `static from(input)` ‚Äì —Å—Ç–≤–æ—Ä—é—î –∫–æ–Ω—Ç–µ–∫—Å—Ç –∑ –æ–±‚Äô—î–∫—Ç–∞ —á–∏ —ñ–Ω—à–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É

### `Event` (–û–û–ü –∫–ª–∞—Å)

–ë–∞–∑–æ–≤–∏–π –∫–ª–∞—Å –¥–ª—è —ñ–Ω–∫–∞–ø—Å—É–ª—è—Ü—ñ—ó –ø–æ–≤–µ–¥—ñ–Ω–∫–∏ –ø–æ–¥—ñ–π.

* **–ú–µ—Ç–æ–¥–∏**
  * `on(event, listener)` ‚Äì –ø—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—è –Ω–∞ –ø–æ–¥—ñ—é
  * `off(event, listener)` ‚Äì –≤—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—è –≤—ñ–¥ –ø–æ–¥—ñ—ó
  * `emit(event, data)` ‚Äì —ñ–Ω—ñ—Ü—ñ—é–≤–∞—Ç–∏ –ø–æ–¥—ñ—é –∑ –¥–∞–Ω–∏–º–∏

## –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥

–Ø–∫ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ playground —Å–∫—Ä–∏–ø—Ç?
```bash
# –ö–ª–æ–Ω—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π —ñ –∑–∞–ø—É—Å—Ç–∏ CLI-–¥–µ–º–æ
git clone https://github.com/nan0web/event.git
cd event
npm install
npm run play
```

## Java‚Ä¢Script

–ó–∞–±–µ–∑–ø–µ—á—É—î –ø–æ–≤–Ω—É –ø—ñ–¥—Ç—Ä–∏–º–∫—É –∞–≤—Ç–æ–¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è —á–µ—Ä–µ–∑ `.d.ts` —Ç–∏–ø–∏.

## –î–æ–ø–æ–º–æ–≥–∞ —É —Ä–æ–∑–≤–∏—Ç–∫—É

–Ø–∫ –¥–æ–ø–æ–º–æ–≥—Ç–∏? ‚Äì [–¥–∏–≤–∏—Å—å —Ç—É—Ç](./CONTRIBUTING.md)

## –õ—ñ—Ü–µ–Ω–∑—ñ—è

–Ø–∫ ISC –ª—ñ—Ü–µ–Ω–∑—ñ—è? ‚Äì [–¥–∏–≤–∏—Å—å —Ç—É—Ç](./LICENSE)
